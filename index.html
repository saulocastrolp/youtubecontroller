<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Music Connect</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="style.css" rel="stylesheet">
    <script>
          let API_URL = "https://youtubecontroller.vercel.app/api";

async function sendCommand(endpoint) {
    await fetch(`${API_URL}/${endpoint}`, { method: "POST" });
}

async function authenticate() {
    window.location.href = `${API_URL}/login`;
}

async function getStatus() {
    const response = await fetch(`${API_URL}/status`);
    const data = await response.json();
    document.getElementById("music-title").innerText = data.title || "Nenhum v√≠deo/m√∫sica tocando";
}

async function getUserInfo() {
            try {
                const response = await fetch(`${API_URL}/user`);
                const data = await response.json();
                
                if (data.error) {
                    document.getElementById("login-btn").style.display = "block";
                    document.getElementById("user-info").style.display = "none";
                } else {
                    document.getElementById("login-btn").style.display = "none";
                    document.getElementById("user-info").style.display = "flex";
                    document.getElementById("user-name").innerText = data.name;
                    document.getElementById("user-photo").src = data.picture;
                }
            } catch (error) {
                console.error("Erro ao obter dados do usu√°rio:", error);
            }
        }

        async function authenticate() {
            window.location.href = `${API_URL}/login`;
        }

        window.onload = getUserInfo;

setInterval(getStatus, 5000);
    </script>
</head>
<body>
    <div class="container">
        <h1> YouTube Music Connect </h1>
        <br/>

        <div id="user-info">
            <img id="user-photo" alt="Foto do Usu√°rio">
            <span id="user-name"></span>
        </div>

        <button class="btn btn-dark" id="login-btn" onclick="authenticate()">üîë Login</button>
        <br/>
        <h2 id="music-title">Nenhuma m√∫sica tocando...</h2>
        <h3 id="artist-name"></h3>
    
        <div class="btn-group">
            <button class="btn btn-dark" onclick="sync()">üîÑ Sincronizar</button>
            <button class="btn btn-dark" onclick="transferPlayback()">üì≤ Transferir Reprodu√ß√£o</button>
        </div>
        <hr/>
        <div class="btn-group">
            <button class="btn btn-dark" onclick="sendCommand('play')">‚ñ∂Ô∏è Play</button>
            <button class="btn btn-dark" onclick="sendCommand('pause')">‚è∏Ô∏è Pause</button>
            <button class="btn btn-dark" onclick="sendCommand('previous')">‚èÆÔ∏è Anterior</button>
            <button class="btn btn-dark" onclick="sendCommand('next')">‚è≠Ô∏è Pr√≥xima</button>
        </div>
        <hr/>
        <div class="btn-group">
            <button class="btn btn-dark" onclick="sendCommand('like')">‚ù§Ô∏è Curtir</button>
            <button class="btn btn-dark" onclick="sendCommand('dislike')">üëé N√£o Curtir</button>
            <button class="btn btn-dark" onclick="sendCommand('shuffle')">üîÄ Aleat√≥rio</button>
            <button class="btn btn-dark" onclick="sendCommand('repeat')">üîÅ Repetir</button>
        </div>
        
    
        <!--br><br>
        <div class="btn-group">
            <button class="btn btn-dark" onclick="syncMusic()">üîÑ Sincronizar M√∫sica</button>
            <button class="btn btn-dark" onclick="playOnDevice()">üì≤ Tocar no Celular/PC</button>
        </div-->
    </div>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>
